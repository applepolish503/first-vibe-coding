# .github/workflows/deploy.yml
name: Deploy Vite site to GitHub Pages

on:
  push:
    branches: [main]           # main ã« push ã•ã‚ŒãŸã‚‰æ¯å›ãƒ‡ãƒ—ãƒ­ã‚¤
  workflow_dispatch:           # æ‰‹å‹•ãƒˆãƒªã‚¬ãƒ¼ã‚‚å¯

permissions:
  contents: read               # Pages ãŒå¿…è¦ã¨ã™ã‚‹æœ€ä½æ¨©é™
  pages: write
  id-token: write

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest

    steps:
      - name: â¬‡ï¸ Checkout
        uses: actions/checkout@v4   # æœ€æ–° v4.x ç³»

      - name: ğŸ“¦ Setup Node
        uses: actions/setup-node@v4 # æœ€æ–° v4.4.0 ç³» :contentReference[oaicite:1]{index=1}
        with:
          node-version: '20'

      - name: ğŸ“¥ Install deps
        # run: npm ci                 # lock ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹å ´åˆ
        # run: npm install          # lock ç„¡ã„å ´åˆã¯ã“ã¡ã‚‰
        run: npm install --no-audit --no-fund

      - run: npm install -D @rollup/rollup-linux-x64-gnu

      - name: ğŸ› ï¸ Build with Vite
        run: npm run build          # â†’ dist/

      - name: ğŸ—œï¸ Upload artifact
        uses: actions/upload-pages-artifact@v3.0.1   # æœ€æ–° v3 ç³» :contentReference[oaicite:2]{index=2}
        with:
          path: ./dist

      - name: âš™ï¸ Configure Pages
        uses: actions/configure-pages@v5             # æœ€æ–° v5 ç³» :contentReference[oaicite:3]{index=3}

      - name: ğŸš€ Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4.0.5            # æœ€æ–° v4 ç³» :contentReference[oaicite:4]{index=4}
